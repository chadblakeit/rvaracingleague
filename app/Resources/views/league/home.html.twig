{% embed '::layout.html.twig' %}

    {% block styles %}
        <style>
            .active-league { display:block;background:#dce6ef;padding:15px 10px 15px 10px;color:#000000;text-align:left;cursor:pointer;border-radius:4px;font-weight:700;font-size:22px;margin-bottom:10px; }
            .active-league:hover { background: #6d8dbf; color: #ffffff;  }
            .active-league .fa-flag-checkered { margin-left: 5px; margin-right: 10px; color: #1a2d4c; }
            .create-league-container { margin-top: 10px; background: #f2f2f2; border-top: 1px solid #ccc; padding: 10px; float: left; width: 100%; }
            .create-league-container .create { display: inline-block; float: left; }
            .create-league-container .invite { display: inline-block; float: right; }
            .renewbtn { float: right; margin-right: 10px; font-size: 18px; color: #218BC3; padding-top: 2px; }
            .active-league:hover .renewbtn { color: #ffffff; }
            .renew-league-container { background: #f2f2f2; border-radius: 4px; padding: 5px 20px 5px 20px;  }
        </style>
    {% endblock %}

    {% block message %}
        <div class="race-name-info dimension-10 mobile-dimension-11">
            <div class="race-name">
                <i class="fa fa-tachometer" aria-hidden="true"></i>
                {{ activerace.racename }}
            </div>
            <div class="race-info">
                {{ activerace.trackname }} in {{ activerace.location }}<br />
                Track Length: {{ activerace.tracklength }}
            </div>
            <div class="race-date">
                {{ activerace.racedate.date | date("F d, Y") }}<span class="race-time">{{ activerace.racedate.date | date("g:ia") }}</span>
            </div>
        </div>
    {% endblock %}

    {% block content %}
        <div class="content-container dimension-10">

            <div class="dashboard-container">
                <h2>League - {{ activeleague.name }}</h2>
                <div class="home-leagues-container">

                    <!-- renewals -->
                    {% if leagueRenewals is not empty %}
                        <div class="renew-league-container">
                            <h3>Renew Leagues</h3>
                            {% for renewal in leagueRenewals %}
                                <div class="active-league">{{ renewal.league.name }}
                                    <div class="renewbtn">Renew League</div>
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                    <form name="leagueForm" id="leagueForm" method="post">
                        <div>
                            <div class="leagues-container">
                                <select name="league_season">
                                    {% for league in leagueSeasons %}
                                        <option value="{{ league.season }}"{% if league_season == league.season %} selected="selected"{% endif %}>{{ league.season }}</option>
                                    {% endfor %}
                                </select>
                                {{ dump(league_season) }}
                                {{ dump(activeleague) }}
                                {#{% for league in myleagues %}
                                    <div class="active-league">
                                        {% if league.league.id == activeleague.id %}
                                            <i class="fa fa-flag-checkered" aria-hidden="true"></i>
                                        {% endif %}
                                        {{ league.league.name }}
                                        <input type="hidden" name="active-league-id" value="{{ league.league.id }}" />
                                    </div>
                                {% endfor %}
                                #}
                            </div>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    {% endblock %}

    {% block javascripts %}
        <script type="text/javascript">
            $(document).ready(function() {
                $("select[name='league_season']").on("change", function(){
                    $.ajax({
                        url: "{{ path('app.rva.changeseason') }}",
                        method: "post",
                        dataType: "json",
                        data: {season: $(this).val(), lid: "{{ league_id }}"},
                        success: function (xhr) {
                            console.log(xhr);
                            window.location.href = '/league/{{ league_id }}';
                        }
                    });
                });
                $(".renewbtn").on("click", function(){
                    $.ajax({
                        url: "{{ path('app.rva.renewleague') }}",
                        method: "post",
                        dataType: "json",
                        data: {lid: "{{ league_id }}"},
                        success: function (xhr) {
                            console.log(xhr);
                            setTimeout(function() { window.location.href = '/league/{{ league_id }}'; }, 2000);
                        }
                    });
                });
            });
        </script>
    {% endblock %}

{% endembed %}

